<!DOCTYPE html>
<html>
  <head>
    <title>Editor de Código | AluraDev</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width = device.width, initial-scale=1">
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="dracula.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Roboto+Mono&display=swap" rel="stylesheet">
    <script src="js/app/polyfill/es6.js"></script>
  </head>

  <body>
    <script src="Post.js"></script>
    <script>

      var openRequest = window.indexedDB.open('AluraDev', 1);

      var connection;

      openRequest.onupgradeneeded = function(e) {
        console.log("Cria ou altera um bando já existente");

        let minhaConnection2 = e.target.result;

        if(minhaConnection2.objectStoreNames.contains('posts')) {
          minhaConnection2.deleteObjectStore('posts');
        };

        minhaConnection2.createObjectStore('posts' , {autoIncrement:true});
      };

      openRequest.onsuccess = function(e) {
        console.log("Conexão obetida com sucesso");
        connection = e.target.result;
      };

      openRequest.onerror = e => {
        console.log(e.target.error);
      };

      function adiciona() {
        let transaction = connection.transaction(['posts'], 'readwrite');

        let store = transaction.objectStore('posts');

        let post = new Post(new Date() , "Meu primeiro Projeto!" , "Definindo uma variável Const", "const idade = 26" , "javascript" , "#FFF" , "Jow");

        let request = store.add(post);

        request.onsuccess = e => {
          console.log("Post incuído com sucesso");

        };

        request.onerror = e => {
          console.log("Não foi possível incluir o post");

        };

      }

      function listaTodos() {

        let transaction = connection.transaction(['posts'], 'readwrite');

        let store = transaction.objectStore('posts');

        let cursor = store.openCursor();

        let posts = [];

        cursor.onsuccess = e => {

          let atual = e.target.result;

          if(atual) {

            let dado = atual.value;

            posts.push(new Posts(dado._data, dado._titulo, dado._descricao, dado._codigo, dado._linguagem, dado._cor, dado._usuario))

            atual.continue();

          } else {

            console.log(posts);

          }
        };

        cursor.onerror = e => {

          console.log(e.target.error.name);

        };

      }

    </script>

    <header class="header">
      <img src="img/Logo.svg" alt="Logo aluraDEV" class="header_img">
      <input type="text" class="header_input" placeholder="Busque por algo">
      <img src="img/vetor_procurar.svg" alt="Botão para ativar barra de buscar" class="botao_procurar">
      <picture class="header_usuario">
        <img src="img/Photo.png" alt="Foto do Usuário" class="header_usuario_foto">
        <figcaption class="header_usuario_nome texto_geral">Henry</figcaption>
      </picture>
    </header>

    <main>

      <div class="menu_toggle">
        <nav>
          <input id="abreFecha_menu_botao" type="checkbox"/>
          <div class="menu_overlay"></div>
          <img src="img/vetor_menu.svg" alt="Botão para acessar ao Menu" class="vetor_menu">
          <img src="img/vetor_fechar_menu.svg" alt="Botão para fechar o Menu" class="vetor_fechar_menu">
          <ul class="menu_navegacao_lista">
            <li class="menu_navegacao_lista_itens">
              <a href="editor.html" class="menu_navegacao_lista_link texto_geral">
                <div class="menu_navegacao_lista_bg_ativo">
                  <img src="img/Icon_editor.svg"  alt="icone do editor de texto">
                </div>
                <p>Editor de Código</p>
              </a>
            </li>
            <li class="menu_navegacao_lista_itens">
              <a href="comunidade.html" class="menu_navegacao_lista_link texto_geral">
                <div class="menu_navegacao_lista_bg">
                  <img src="img/Vector_comunidade.svg" alt="icone para acesso à comunidade">
                </div>
                <p>Comunidade</p>
              </a>
            </li>
            <picture class="header_usuario_toggle">
              <img src="img/Photo.png" alt="Foto do Usuário" class="header_usuario_foto">
              <figcaption class="header_usuario_nome texto_geral">Henry</figcaption>
            </picture>
          </ul>
        </nav>
      </div>

      <div class="corpo">

        <div class="menu">
          <h2 class="menu_titulo texto_geral">Menu</h2>
          <nav class="menu_navegacao">
            <ul class="menu_navegacao_lista">
              <li class="menu_navegacao_lista_itens">
                <a href="editor.html" class="menu_navegacao_lista_link texto_geral">
                  <div class="menu_navegacao_lista_bg_ativo">
                    <img src="img/Icon_editor.svg"  alt="icone do editor de texto">
                  </div>
                  <p>Editor de Código</p>
                </a>
              </li>
              <li class="menu_navegacao_lista_itens">
                <a href="comunidade.html" class="menu_navegacao_lista_link texto_geral">
                  <div class="menu_navegacao_lista_bg">
                    <img src="img/Vector_comunidade.svg" alt="icone para acesso à comunidade">
                  </div>
                  <p>Comunidade</p>
                </a>
              </li>
            </ul>
          </nav>
        </div>
  
        <div class="codigo">
          <div class="codigo_caixa">
            <div class="codigo_caixa_preta">
              <div class="codigo_caixa_pontos">
                <img src="img/Bola_Vermelha.svg" alt="Bola Vermelha" class="codigo_caixa_pontos_ponto">
                <img src="img/Bola_amarela.svg" alt="Bola Amarela" class="codigo_caixa_pontos_ponto">
                <img src="img/Bola_verde.svg" alt="Bola Verde" class="codigo_caixa_pontos_ponto">
              </div>
              <div class="areaCodigo">
                <pre><code id="codigo_input" class="codigo_caixa_input" contenteditable="true"></code></pre>
              </div>
            </div>
          </div>
          <a href="#" class="codigo_botao_link texto_geral"><div class="highlight_botao">Visualizar o highlight</div></a>
        </div>
        
        <div class="opcoes">
          <div class="opcoes_projeto">
            <h2 class="opcoes_projeto_titulo texto_geral">Seu Projeto</h2>
            <input type="text" class="opcoes_caixa" placeholder="Nome do seu projeto">
            <textarea class="opcoes_projeto_descricao texto_geral" placeholder="Descrição do seu projeto" cols="30" rows="3"></textarea>
          </div>
  
          <div class="opcoes_personalizacao">
            <h2 class="opcoes_personalizacao_titulo texto_geral">Personalização</h2>
            <div class="opcoes_listas_cor_codigo">
              <select name="" id="linguagem" class="opcoes_personalizacao_tipo_codigo">
                <option value="javascript" class="opcoes_personalizacao_opcoes texto_geral">JavaScript</option>
                <option value="python" class="opcoes_personalizacao_opcoes texto_geral">Python</option>
              </select>
              <div class="opcoes_borda_seletor_cor">
                <input type="color" id="favcolor" name="favcolor" value="#9AFF6B">
                </select>
              </div>
            </div>

          </div>
          <a href="#" class="botao_salvar_texto texto_geral">
            <div class="botao_salvar">
              <p>Salvar projeto</p>
            </div>
        </a>
  
        </div>

      </div>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
      <script src="highlight_i.js"></script>
      <script src="bgcolor.js"></script>
      <script src="inert.js"></script>
      <script src="closeMenu.js"></script>


          
    <div id="postsView"></div>
    
    <script src="js/app/models/Post.js"></script>
    <script src="js/app/controllers/PostController.js"></script>
    <script src="js/app/helpers/DateHelper.js"></script>
    <script src="js/app/models/ListaPosts.js"></script>
    <script src="js/app/views/View.js"></script>
    <script src="js/app/views/PostsView.js"></script>
    <script src="js/app/models/Mensagem.js"></script>
    <script src="js/app/views/MensagemView.js"></script>
    <script src="js/app/services/ProxyFactory.js"></script>
    <script src="js/app/helpers/Bind.js"></script>
    <script src="js/app/services/PostService.js"></script>
    <script src="js/app/services/HttpService.js"></script>
    <script src="js/app/services/ConnectionFactory.js"></script>
    <script src="js/app/dao/PostDao.js"></script>
    <script>
        var postController = new PostController();
    </script>

    
    </main>

  </body>
  
</html>